C51 COMPILER V9.60.0.0   UART                                                              01/29/2024 00:24:31 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE UART
OBJECT MODULE PLACED IN .\output\uart.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE user\uart.c ROM(COMPACT) OPTIMIZE(8,SPEED) BROWSE INCDIR(.\user;.\STD_LI
                    -B) DEBUG OBJECTEXTEND PRINT(.\output\uart.lst) TABS(2) OBJECT(.\output\uart.obj)

line level    source

   1          #include "uart.h"
   2          #include "delay.h"
   3          
   4          uint8 busy[5]; // 接收忙标志位
   5          
   6          void UART_init(void)
   7          {
   8   1          SCON = 0x50;  // 8位数据,可变波特率
   9   1          AUXR |= 0x40; // 定时器时钟1T模式
  10   1          AUXR &= 0xFE; // 串口1选择定时器1为波特率发生器
  11   1          TMOD &= 0x0F; // 设置定时器模式
  12   1          TL1 = 0xE8;   // 设置定时初始值
  13   1          TH1 = 0xFF;   // 设置定时初始值
  14   1          ET1 = 0;      // 禁止定时器中断
  15   1          TR1 = 1;      // 定时器1开始计时
  16   1          ES  = 1;      // 使能串口1中断
  17   1      }
  18          
  19          void uart_putchar(uint8 dat)
  20          {
  21   1          while (busy[1])
  22   1              ;
  23   1          
  24   1          busy[1] = 1;
  25   1          SBUF    = dat;
  26   1      }
  27          
  28          void uart_putstr(uint8 *str, uint16 len)
  29          {
  30   1          while (len--)
  31   1              uart_putchar(*str++);
  32   1      }
  33          
  34          // 串口发送、接收中断
  35          // void UartIsr() interrupt 4
  36          // {
  37          //     uint8 res;
  38          //     static uint8 dwon_count;
  39          //     if (TI) {
  40          //         TI      = 0; // 发送中断标志位清除
  41          //         busy[1] = 0;
  42          
  43          
  44          //     P55 = 1;
  45          //     delay_ms(100);
  46          //     P55     = 0;
  47          //     //测试
  48          
  49          
  50          //     }
  51          //     if (RI) {
  52          //         RI  = 0; // 接收中断标志位清除
  53          //         res = SBUF;
  54          //         // 程序自动下载
C51 COMPILER V9.60.0.0   UART                                                              01/29/2024 00:24:31 PAGE 2   

  55          //         if (res == 0x7F || res == 0x80) {
  56          //             if (dwon_count++ > 20)
  57          //                 IAP_CONTR = 0x60;
  58          //         } else {
  59          //             dwon_count = 0;
  60          //         }
  61          //     }
  62          // }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     75    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
